# Generic tests for servers (do not require FEDERATED)
set sql_mode="";
SET NAMES utf8mb4;

--echo #
--echo # MDEV-4594 - CREATE SERVER crashes embedded
--echo #
CREATE SERVER s1 FOREIGN DATA WRAPPER mysql OPTIONS(HOST 'localhost');
SELECT * FROM mysql.servers;
DROP SERVER s1;

CREATE SERVER s1 FOREIGN DATA WRAPPER foo OPTIONS(USER 'bar');
SELECT * FROM mysql.servers;
DROP SERVER s1;

--error ER_CANT_CREATE_FEDERATED_TABLE
CREATE SERVER s1 FOREIGN DATA WRAPPER mysql OPTIONS(USER 'bar');

CREATE SERVER s1 FOREIGN DATA WRAPPER mysql OPTIONS(HOST 'bar');
SELECT * FROM mysql.servers;
DROP SERVER s1;

CREATE SERVER s1 FOREIGN DATA WRAPPER mysql OPTIONS(SOCKET 'bar');
SELECT * FROM mysql.servers;
DROP SERVER s1;


--echo #
--echo # Start of 11.7 tests
--echo #

--echo #
--echo # MDEV-27490 Allow full utf8mb4 for identifiers
--echo #

CREATE SERVER ðŸ˜Ž FOREIGN DATA WRAPPER ðŸ˜Ž
OPTIONS(
  HOST 'ðŸ˜Ž',
  DATABASE 'ðŸ˜Ž',
  USER 'ðŸ˜Ž',
  PASSWORD 'ðŸ˜Ž',
  SOCKET '/tmp/ðŸ˜Ž.sock',
  OWNER 'ðŸ˜Ž'
);
--vertical_results
SELECT * FROM mysql.servers;
--horizontal_results
DROP SERVER ðŸ˜Ž;

--echo #
--echo # End of 11.7 tests
--echo #
